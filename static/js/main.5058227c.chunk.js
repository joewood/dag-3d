(this["webpackJsonpdag-3d"]=this["webpackJsonpdag-3d"]||[]).push([[0],{135:function(e,t,a){e.exports=a(319)},139:function(e,t,a){},140:function(e,t,a){},319:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(32),o=a.n(i),c=(a(139),a(140),a(9)),l=a(2),h=a(76),s=a(4);var m=function(e){var t=function(e){var t=Object(c.c)().camera,a=Object(n.useState)({pos:{x:0,y:0,z:5},vel:{x:0,y:0,z:0}}),r=Object(s.a)(a,2),i=r[0],o=r[1],h=Object(n.useState)([0,0,-1]),m=Object(s.a)(h,2),d=m[0],u=m[1],g=Object(n.useCallback)((function(t){var a=t.clock.getElapsedTime()/2,n=Math.floor(a)%e.length,r=(n+1)%e.length;Math.floor(a);o((function(t){return{vel:{x:.95*(.002*(e[n].x-t.pos.x)+t.vel.x),y:.95*(.002*(e[n].y-t.pos.y)+t.vel.y),z:0},pos:{x:t.pos.x+t.vel.x,y:t.pos.y+t.vel.y,z:t.pos.z+t.vel.z}}})),u((function(t){return[.002*(e[r].x-t[0])+t[0],.002*(e[r].y-t[1])+t[1],t[2]]}))}),[e]);return Object(c.b)(g),t.position.set(i.pos.x,i.pos.y,i.pos.z),t.lookAt(new l.Vector3(i.pos.x+3*i.vel.x,i.pos.y+3*i.vel.y,d[2])),[i.pos.x,i.pos.y,i.pos.z]}(e.points);return r.a.createElement("camera",{attach:"camera",position:t})},d=a(55),u=Object(n.forwardRef)((function(e,t){var a=e.width,i=e.height,o=e.text,l=e.backgroundColor,h=e.color,s=e.depth,m=Object(d.a)(e,["width","height","text","backgroundColor","color","depth"]),u=a||1,g=i||.3,f=o||"<null>",p=Object(n.useMemo)((function(){var e=document.createElement("canvas"),t=e.getContext("2d");if(!t)return null;var a=20*u,n=20*g;e.style.position="absolute",e.style.top="calc(50% - ".concat(n/2,"px)"),e.style.width=a+"px",e.style.height=n+"px",e.width=20*a,e.height=20*n,t.scale(20,20),t.fillStyle=l||"grey",t.fillRect(0,0,a,n);var r=n/1.8;t.font="bold ".concat(r,"px Arial, sans-serif"),t.fillStyle=h||"white",t.textAlign="center",t.textBaseline="middle";var i=a/2,o=n/2;return t.fillText(f,i,o),e}),[a,i,h,l,o]);Object(c.c)().viewport;return r.a.createElement("mesh",Object.assign({ref:t},m),r.a.createElement("boxBufferGeometry",{args:[u,g,s||.06],attach:"geometry"}),r.a.createElement("meshStandardMaterial",{attachArray:"material",color:l}),r.a.createElement("meshStandardMaterial",{attachArray:"material",color:l}),r.a.createElement("meshStandardMaterial",{attachArray:"material",color:l}),r.a.createElement("meshStandardMaterial",{attachArray:"material",color:l}),r.a.createElement("meshStandardMaterial",{attachArray:"material"},r.a.createElement("canvasTexture",{attach:"map",image:p})),r.a.createElement("meshStandardMaterial",{attachArray:"material"},r.a.createElement("canvasTexture",{attach:"map",image:p})))})),g=function(e){var t=e.spinX,a=e.spinY,i=Object(d.a)(e,["spinX","spinY"]),o=Object(n.useRef)(null);return Object(c.b)((function(e){var n=e.clock,r=o.current;r&&r.rotation.set(n.getElapsedTime()*(t||0),n.getElapsedTime()*(a||0),0)})),r.a.createElement(u,Object.assign({ref:o},i))};var f=function(e){var t=e.graph,a=Object(c.c)(),i=a.viewport,o=(a.size,function(e){return(e-t.width[0])*i.width/(t.width[1]-t.width[0])-i.width/2}),h=function(e){return(e-t.height[0])*i.height/(t.height[1]-t.height[0])-i.height/2},d=function(e){var t=Object(n.useState)(0),a=Object(s.a)(t,2),r=a[0],i=a[1],o=Object(n.useCallback)((function(t){var a=t.clock.getElapsedTime()/2,n=Math.floor(a)%e.length;i(n)}),[e]);return Object(c.b)(o),r}(t.nodes),u=Object(n.useMemo)((function(){return t.nodes.map((function(e){return new l.Vector3(o(e.x),h(e.y),-.1)}))}),[t]);return console.log({selectedNode:d}),r.a.createElement(r.a.Fragment,null,r.a.createElement(m,{points:u}),t.nodes.map((function(e,a){return r.a.createElement(g,{key:e.name+d,text:e.name,spinX:"Client"===e.name||"Config"===e.name?.6:0,color:a===d?"black":"white",width:(c=e.width,c*i.width/(t.width[1]-t.width[0])),height:(n=e.height,n*i.height/(t.height[1]-t.height[0])),backgroundColor:"#4070f0",depth:.3,position:[o(e.x),h(e.y),-.1]});var n,c})),t.edges.map((function(e){var t=new l.CatmullRomCurve3(e.points.map((function(e){return new l.Vector3(o(e.x),h(e.y),-.1)})),!1,"catmullrom");return r.a.createElement("mesh",null,r.a.createElement("tubeGeometry",{attach:"geometry",args:[t,30,.03,8,!1]}),r.a.createElement("meshPhongMaterial",{attach:"material",color:"#606010"}))})))},p=function(){var e=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"LR";return Object(n.useMemo)((function(){var n=new h.graphlib.Graph({directed:!0});n.setGraph({rankdir:a,edgesep:2,marginx:20,marginy:20}),n.setDefaultEdgeLabel((function(){return{}}));var r=!0,i=!1,o=void 0;try{for(var c,l=e[Symbol.iterator]();!(r=(c=l.next()).done);r=!0){var s=c.value;n.setNode(s.name,{label:s.name,width:s.width,height:s.height})}}catch(x){i=!0,o=x}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}var m=!0,d=!1,u=void 0;try{for(var g,f=t[Symbol.iterator]();!(m=(g=f.next()).done);m=!0){var p=g.value;n.setEdge(p.from,p.to,{minlen:1})}}catch(x){d=!0,u=x}finally{try{m||null==f.return||f.return()}finally{if(d)throw u}}Object(h.layout)(n);var y=n.nodes().map((function(e){return{name:e,width:n.node(e).width,height:n.node(e).height,x:n.node(e).x,y:n.node(e).y}})),v=y.reduce((function(e,t){return[Math.min(t.x,e[0]),Math.max(t.x+t.width,e[1])]}),[0,0]),w=y.reduce((function(e,t){return[Math.min(t.y,e[0]),Math.max(t.y+t.height,e[1])]}),[0,0]);return{nodes:y,width:v,height:w,edges:n.edges().map((function(e){return{points:n.edge(e).points}}))}}),[e,t])}([{name:"Config",width:60,height:8},{name:"Ref Data Svc",width:60,height:8},{name:"EOD Prices",width:60,height:8},{name:"MD Sys",width:60,height:8},{name:"Client",width:60,height:8},{name:"Client Int",width:60,height:8},{name:"VWAP Engine",width:60,height:8},{name:"OMS",width:60,height:8},{name:"Exch Links",width:60,height:8},{name:"Trading Sys",width:60,height:8}],[{from:"Config",to:"VWAP Engine"},{from:"Client",to:"Client Int"},{from:"Client Int",to:"OMS"},{from:"Ref Data Svc",to:"VWAP Engine"},{from:"MD Sys",to:"VWAP Engine"},{from:"EOD Prices",to:"VWAP Engine"},{from:"VWAP Engine",to:"OMS"},{from:"OMS",to:"Exch Links"},{from:"Exch Links",to:"Trading Sys"},{from:"Trading Sys",to:"Client Int"}],"RL");return r.a.createElement(c.a,{pixelRatio:window.devicePixelRatio},r.a.createElement("ambientLight",null),r.a.createElement("spotLight",{position:[-7,1,3],color:new l.Color("#fff"),intensity:.8,rotation:[-.2,1.2,0]}),r.a.createElement("spotLight",{position:[0,-5,3],color:new l.Color("#fff"),intensity:.8,rotation:[1.2,0,0]}),r.a.createElement(f,{graph:e}))},y=function(){return r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},"DAG 3D Component"),r.a.createElement(p,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(y,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[135,1,2]]]);
//# sourceMappingURL=main.5058227c.chunk.js.map