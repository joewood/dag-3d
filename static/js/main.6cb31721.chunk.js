(this["webpackJsonpdag-3d"]=this["webpackJsonpdag-3d"]||[]).push([[0],{135:function(e,t,n){e.exports=n(319)},139:function(e,t,n){},140:function(e,t,n){},319:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(32),o=n.n(i),c=(n(139),n(140),n(11)),l=n(2),h=n(4),m=n(76);var u=function(e){var t=function(e){var t=Object(c.c)().camera,n=Object(a.useState)({pos:{x:0,y:0,z:5},vel:{x:0,y:0,z:0}}),r=Object(h.a)(n,2),i=r[0],o=r[1],m=Object(a.useCallback)((function(){o((function(t){return{vel:{x:.95*(.004*(e.x-t.pos.x)+t.vel.x),y:.95*(.004*(e.y-t.pos.y)+t.vel.y),z:0},pos:{x:t.pos.x+t.vel.x,y:t.pos.y+t.vel.y,z:t.pos.z+t.vel.z}}}))}),[e]);return Object(c.b)(m),t.lookAt(new l.Vector3(i.pos.x+3*i.vel.x,i.pos.y+3*i.vel.y,-1)),t.position.set(i.pos.x,i.pos.y,i.pos.z),[i.pos.x,i.pos.y,i.pos.z]}(e.targetPosition);return r.a.createElement("camera",{attach:"camera",position:t})},s=n(55),d=Object(a.forwardRef)((function(e,t){var n=e.width,i=e.height,o=e.text,c=e.backgroundColor,l=e.color,h=e.depth,m=e.onClick,u=Object(s.a)(e,["width","height","text","backgroundColor","color","depth","onClick"]),d=n||1,f=i||.3,g=o||"<null>",p=Object(a.useMemo)((function(){var e=document.createElement("canvas"),t=e.getContext("2d");if(!t)return null;var n=20*d,a=20*f;e.style.position="absolute",e.style.top="calc(50% - ".concat(a/2,"px)"),e.style.width=n+"px",e.style.height=a+"px",e.width=20*n,e.height=20*a,t.scale(20,20),t.fillStyle=c||"grey",t.fillRect(0,0,n,a);var r=a/1.8;t.font="bold ".concat(r,"px Arial, sans-serif"),t.fillStyle=l||"white",t.textAlign="center",t.textBaseline="middle";var i=n/2,o=a/2;return t.fillText(g,i,o),e}),[d,f,l,c,g]),y=Object(a.useCallback)((function(e){m({text:o})}),[o,m]);return r.a.createElement("mesh",Object.assign({ref:t,onClick:y},u),r.a.createElement("boxBufferGeometry",{args:[d,f,h||.06],attach:"geometry"}),r.a.createElement("meshStandardMaterial",{attachArray:"material",color:c}),r.a.createElement("meshStandardMaterial",{attachArray:"material",color:c}),r.a.createElement("meshStandardMaterial",{attachArray:"material",color:c}),r.a.createElement("meshStandardMaterial",{attachArray:"material",color:c}),r.a.createElement("meshStandardMaterial",{key:"front",attachArray:"material"},r.a.createElement("canvasTexture",{attach:"map",image:p})),r.a.createElement("meshStandardMaterial",{key:"back",attachArray:"material"},r.a.createElement("canvasTexture",{attach:"map",image:p})))})),f=function(e){var t=e.spinX,n=e.spinY,i=Object(s.a)(e,["spinX","spinY"]),o=Object(a.useRef)(null);return Object(c.b)((function(e){var a=e.clock,r=o.current;r&&r.rotation.set(a.getElapsedTime()*(t||0),a.getElapsedTime()*(n||0),0)})),r.a.createElement(d,Object.assign({ref:o},i))};function g(e,t){var n,r=Object(a.useState)(0),i=Object(h.a)(r,2),o=i[0],l=i[1];return Object(c.b)((function(e){var t=e.clock;return l(300*t.getElapsedTime()%1e3/1e3)})),(n=e,Object(a.useMemo)((function(){for(var e=[],t=0;t<n;t++)e.push(t);return e}),[n])).map((function(n){return t.getPointAt(1e3*(n/e+o)%1e3/1e3)}))}var p=function(e){var t=e.path,n=e.points;return r.a.createElement(r.a.Fragment,null,g(n,t).map((function(e,t){return r.a.createElement("mesh",{key:t,position:e},r.a.createElement("sphereGeometry",{attach:"geometry",args:[.07]}),r.a.createElement("meshPhongMaterial",{attach:"material",color:"#6060a0"}))})))},y=function(e){var t=e.graph,n=Object(c.c)().viewport,i=Object(a.useCallback)((function(e){return(e-t.width[0])*n.width/(t.width[1]-t.width[0])-n.width/2}),[n,t]),o=Object(a.useCallback)((function(e){return(e-t.height[0])*n.height/(t.height[1]-t.height[0])-n.height/2}),[t,n]),m=Object(a.useCallback)((function(e){return e*n.width/(t.width[1]-t.width[0])}),[n,t]),s=Object(a.useCallback)((function(e){return e*n.height/(t.height[1]-t.height[0])}),[n,t]),d=Object(a.useState)(0),g=Object(h.a)(d,2),y=g[0],b=g[1],v=Object(a.useMemo)((function(){return t.nodes.map((function(e){return new l.Vector3(i(e.x),o(e.y),-.1)}))}),[t,i,o]),w=Object(a.useCallback)((function(e){var n=e.text,a=t.nodes.findIndex((function(e){return e.name===n}));a>=0&&b(a)}),[t,b]),E=function(e,t,n){return Object(a.useMemo)((function(){return e.map((function(e){return new l.CatmullRomCurve3(e.points.map((function(e){return new l.Vector3(t(e.x),n(e.y),-.1)})),!1,"catmullrom")}))}),[e,t,n])}(t.edges,i,o);return r.a.createElement(r.a.Fragment,null,r.a.createElement(u,{targetPosition:v[y]}),t.nodes.map((function(e,t){return r.a.createElement(f,{key:e.name,onClick:w,text:e.name,spinX:"Client"===e.name||"Config"===e.name?.6:0,color:t===y?"black":"white",width:m(e.width),height:s(e.height),backgroundColor:"#4070f0",depth:.3,position:[i(e.x),o(e.y),-.1]})})),E.map((function(e,t){return r.a.createElement("mesh",{key:"mesh"+t},r.a.createElement("tubeGeometry",{attach:"geometry",args:[e,30,.03,8,!1]}),r.a.createElement("meshPhongMaterial",{attach:"material",color:"#606010"}))})),E.map((function(e,t){return r.a.createElement(p,{path:e,points:3})})))},b=function(){var e=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"LR";return Object(a.useMemo)((function(){var a=new m.graphlib.Graph({directed:!0});a.setGraph({rankdir:n,edgesep:2,marginx:20,marginy:20}),a.setDefaultEdgeLabel((function(){return{}}));var r=!0,i=!1,o=void 0;try{for(var c,l=e[Symbol.iterator]();!(r=(c=l.next()).done);r=!0){var h=c.value;a.setNode(h.name,{label:h.name,width:h.width,height:h.height})}}catch(w){i=!0,o=w}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}var u=!0,s=!1,d=void 0;try{for(var f,g=t[Symbol.iterator]();!(u=(f=g.next()).done);u=!0){var p=f.value;a.setEdge(p.from,p.to,{minlen:1})}}catch(w){s=!0,d=w}finally{try{u||null==g.return||g.return()}finally{if(s)throw d}}Object(m.layout)(a);var y=a.nodes().map((function(e){return{name:e,width:a.node(e).width,height:a.node(e).height,x:a.node(e).x,y:a.node(e).y}})),b=y.reduce((function(e,t){return[Math.min(t.x,e[0]),Math.max(t.x+t.width,e[1])]}),[0,0]),v=y.reduce((function(e,t){return[Math.min(t.y,e[0]),Math.max(t.y+t.height,e[1])]}),[0,0]);return{nodes:y,width:b,height:v,edges:a.edges().map((function(e){return{points:a.edge(e).points}}))}}),[e,t,n])}([{name:"Config",width:60,height:8},{name:"Ref Data Svc",width:60,height:8},{name:"EOD Prices",width:60,height:8},{name:"MD Sys",width:60,height:8},{name:"Client",width:60,height:8},{name:"Client Int",width:60,height:8},{name:"VWAP Engine",width:60,height:8},{name:"OMS",width:60,height:8},{name:"Exch Links",width:60,height:8},{name:"Trading Sys",width:60,height:8}],[{from:"Config",to:"VWAP Engine"},{from:"Client",to:"Client Int"},{from:"Client Int",to:"OMS"},{from:"Ref Data Svc",to:"VWAP Engine"},{from:"MD Sys",to:"VWAP Engine"},{from:"EOD Prices",to:"VWAP Engine"},{from:"VWAP Engine",to:"OMS"},{from:"OMS",to:"Exch Links"},{from:"Exch Links",to:"Trading Sys"},{from:"Trading Sys",to:"Client Int"}],"RL");return r.a.createElement(c.a,{pixelRatio:window.devicePixelRatio},r.a.createElement("ambientLight",null),r.a.createElement("spotLight",{position:[-7,1,3],color:new l.Color("#fff"),intensity:.8,rotation:[-.2,1.2,0]}),r.a.createElement("spotLight",{position:[0,-5,3],color:new l.Color("#fff"),intensity:.8,rotation:[1.2,0,0]}),r.a.createElement(y,{graph:e}))},v=function(){return r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},"DAG 3D Component"),r.a.createElement(b,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(v,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[135,1,2]]]);
//# sourceMappingURL=main.6cb31721.chunk.js.map