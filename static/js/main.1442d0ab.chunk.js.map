{"version":3,"sources":["text.tsx","graph.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["Text","forwardRef","ref","width","height","text","backgroundColor","color","depth","props","_width","_height","_text","textCanvas","useMemo","canvas","document","createElement","context","getContext","textureWidth","textureHeight","style","position","top","scale","fillStyle","fillRect","fontSize","font","textAlign","textBaseline","x","y","fillText","useThree","viewport","args","attach","attachArray","image","Cam","pos","points","camera","useState","z","vel","camPos","setCamPos","camLooKAt","setCamLookAt","cb","useCallback","time","clock","getElapsedTime","index","Math","floor","length","next","useFrame","set","lookAt","Vector3","useCameraPan","extend","OrbitControls","Graph","graph","convertGraphX","size","convertGraphY","selectedNode","setIndex","useSelectedNode","nodes","map","n","console","log","i","key","name","edges","edge","path","CatmullRomCurve3","point","App","direction","g","graphlib","directed","setGraph","rankdir","edgesep","marginx","marginy","setDefaultEdgeLabel","node","setNode","label","setEdge","from","to","minlen","layout","retnodes","reduce","p","c","min","max","e","useDag","pixelRatio","window","devicePixelRatio","Color","rotation","className","Boolean","location","hostname","match","ReactDOM","render","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.1442d0ab.chunk.js","sourcesContent":["import React, { forwardRef, Ref, useMemo } from 'react';\nimport { ReactThreeFiber, useThree } from 'react-three-fiber';\nimport { Mesh } from 'three';\n\nexport type MeshProps = ReactThreeFiber.Object3DNode<Mesh, typeof Mesh>;\n\nexport interface TextProps {\n    width?: number;\n    height?: number;\n    text?: string;\n    depth?: number;\n    backgroundColor?: string;\n    color?: string;\n    position: number[];\n}\n\n\nexport const Text = forwardRef(({ width, height, text, backgroundColor, color, depth, ...props }: TextProps, ref: Ref<MeshProps>) => {\n    const _width = width || 1\n    const _height = height || 0.3\n    const _text = text || '<null>'\n    const textCanvas = useMemo(() => {\n        const canvas = document.createElement('canvas')\n        const context = canvas.getContext('2d')\n        if (!context) return null;\n        const textureWidth = _width * 20;\n        const textureHeight = _height * 20;\n        canvas.style.position = 'absolute'\n        canvas.style.top = `calc(50% - ${textureHeight / 2}px)`\n        canvas.style.width = textureWidth + 'px'\n        canvas.style.height = textureHeight + 'px'\n        canvas.width = textureWidth * 20\n        canvas.height = textureHeight * 20\n        context.scale(20, 20)\n        context.fillStyle = backgroundColor || 'grey'\n        context.fillRect(0, 0, textureWidth, textureHeight)\n        const fontSize = textureHeight / 1.5;\n        context.font = `bold ${fontSize}px Arial, sans-serif`\n        context.fillStyle = color || 'white'\n        context.textAlign = 'center'\n        context.textBaseline = 'middle'\n        const x = textureWidth / 2\n        const y = textureHeight / 2\n        context.fillText(_text, x, y)\n        return canvas\n    }, [width, height, color, backgroundColor, text])\n\n    const { viewport } = useThree()\n    return (\n        <mesh ref={ref} {...props}>\n            <boxBufferGeometry args={[_width, _height, depth || 0.06]} attach=\"geometry\" />\n            <meshStandardMaterial attachArray=\"material\" color=\"grey\" />\n            <meshStandardMaterial attachArray=\"material\" color=\"grey\" />\n            <meshStandardMaterial attachArray=\"material\" color=\"grey\" />\n            <meshStandardMaterial attachArray=\"material\" color=\"grey\" />\n\n            <meshStandardMaterial attachArray=\"material\">\n                <canvasTexture attach=\"map\" image={textCanvas} />\n            </meshStandardMaterial>\n            <meshStandardMaterial attachArray=\"material\">\n                <canvasTexture attach=\"map\" image={textCanvas} />\n            </meshStandardMaterial>\n        </mesh>\n    )\n})\n\n","import { graphlib, layout } from \"dagre\"\nimport React, { FC, useMemo, useRef, Ref, useState, useCallback } from 'react'\nimport { Canvas, useThree, extend, ReactThreeFiber, useFrame } from 'react-three-fiber'\nimport { Text } from \"./text\"\nimport { SpinText } from \"./spin-text\"\nimport { Vector3, Mesh, CurvePath, Curve, CatmullRomCurve3, Color, Colors, Vector } from \"three\"\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls'\n\ninterface Node {\n\tname: string;\n\twidth: number;\n\theight: number;\n}\n\ninterface Edge {\n\tfrom: string;\n\tto: string;\n}\n\n\n\ninterface PositionedNode {\n\tname: string;\n\twidth: number;\n\theight: number;\n\tx: number;\n\ty: number;\n}\n\ninterface PositionedEdge {\n\tname?: string;\n\tpoints: { x: number, y: number }[]\n}\n\n\ninterface Layout {\n\tnodes: PositionedNode[];\n\tedges: PositionedEdge[];\n\twidth: [number, number];\n\theight: [number, number];\n}\n\nfunction useDag(nodes: Node[], edges: Edge[], direction = \"LR\"): Layout {\n\treturn useMemo(() => {\n\t\tconst g = new graphlib.Graph({ directed: true });\n\t\tg.setGraph({ rankdir: direction, edgesep: 2, marginx: 20, marginy: 20 });\n\t\tg.setDefaultEdgeLabel(() => { return {} });\n\t\tfor (const node of nodes) {\n\t\t\tg.setNode(node.name, { label: node.name, width: node.width, height: node.height });\n\t\t}\n\n\t\tfor (const edge of edges) {\n\t\t\t// Add edges to the graph.\n\t\t\tg.setEdge(edge.from, edge.to, { minlen: 1 });\n\t\t}\n\t\tlayout(g);\n\t\tconst retnodes = g.nodes().map(n => ({ name: n, width: g.node(n).width, height: g.node(n).height, x: g.node(n).x, y: g.node(n).y }));\n\t\tconst width = retnodes.reduce((p, c) => [Math.min(c.x, p[0]), Math.max(c.x + c.width, p[1])], [0, 0]) as [number, number]\n\t\tconst height = retnodes.reduce((p, c) => [Math.min(c.y, p[0]), Math.max(c.y + c.height, p[1])], [0, 0]) as [number, number]\n\t\tconst retedges = g.edges().map(e => ({ points: g.edge(e).points }));\n\t\treturn { nodes: retnodes, width, height, edges: retedges }\n\t}, [nodes, edges])\n}\n\nextend({ OrbitControls })\n\nfunction Controls() {\n\tconst controls = useRef() as any //Ref<ReactThreeFiber.Object3DNode<OrbitControls,typeof OrbitControls>>\n\tconst { camera, gl } = useThree()\n\tuseFrame(() => controls && controls.current && controls.current.update())\n\treturn (\n\t\t<orbitControls ref={controls} args={[camera, gl.domElement]} enableDamping dampingFactor={0.1} rotateSpeed={0.5} />\n\t)\n}\n\nfunction useSelectedNode(points: any[]) {\n\tconst [index, setIndex] = useState(0);\n\tconst cb = useCallback(({ clock }: any) => {\n\t\tconst time = clock.getElapsedTime() / 2\n\t\tconst index = Math.floor(time) % points.length;\n\t\tsetIndex(index);\n\t}, [points])\n\tuseFrame(cb);\n\treturn index;\n}\n\nfunction useCameraPan(points: Vector3[]) {\n\tconst { camera } = useThree();\n\tconst [camPos, setCamPos] = useState({ pos: { x: 0, y: 0, z: 4 }, vel: { x: 0, y: 0, z: 0 } })\n\tconst [camLooKAt, setCamLookAt] = useState([0, 0, -1])\n\tconst cb = useCallback(({ clock }: any) => {\n\t\tconst time = clock.getElapsedTime() / 2\n\t\tconst index = Math.floor(time) % points.length;\n\t\tconst next = (index + 1) % points.length;\n\t\tconst secFraction = time - Math.floor(time);\n\n\t\tsetCamPos(pos => ({\n\t\t\tvel: {\n\t\t\t\tx: ((points[index].x - pos.pos.x) * 0.002 + pos.vel.x) * 0.95,\n\t\t\t\ty: ((points[index].y - pos.pos.y) * 0.002 + pos.vel.y) * 0.95,\n\t\t\t\tz: 0//Math.sin(secFraction * 2 * Math.PI) / 500\n\t\t\t},\n\t\t\tpos: {\n\t\t\t\tx: pos.pos.x + pos.vel.x,\n\t\t\t\ty: pos.pos.y + pos.vel.y,\n\t\t\t\tz: pos.pos.z + pos.vel.z\n\t\t\t}\n\t\t}));\n\t\tsetCamLookAt(pos => [(points[next].x - pos[0]) * 0.002 + pos[0], (points[next].y - pos[1]) * 0.002 + pos[1], pos[2]])\n\t}, [points])\n\tuseFrame(cb);\n\tcamera.position.set(camPos.pos.x, camPos.pos.y, camPos.pos.z)\n\tcamera.lookAt(new Vector3(camPos.pos.x + camPos.vel.x * 3, camPos.pos.y + camPos.vel.y * 3, camLooKAt[2]))\n\treturn [camPos.pos.x, camPos.pos.y, camPos.pos.z];\n}\n\nfunction Cam({ points }: { points: Vector3[] }) {\n\tconst pos = useCameraPan(points);\n\treturn <camera attach=\"camera\" position={pos} />\n}\n\n\ninterface GraphProps {\n\tgraph: Layout;\n}\nconst Graph: FC<GraphProps> = ({ graph }) => {\n\tconst { viewport, size } = useThree();\n\tconst convertGraphX = (x: number) => (x - graph.width[0]) * (viewport.width) / (graph.width[1] - graph.width[0]) - viewport.width / 2\n\tconst convertGraphY = (y: number) => (y - graph.height[0]) * (viewport.height) / (graph.height[1] - graph.height[0]) - viewport.height / 2\n\tconst convertWidth = (width: number) => width * viewport.width / (graph.width[1] - graph.width[0])\n\tconst convertHeight = (height: number) => height * viewport.height / (graph.height[1] - graph.height[0])\n\tconst selectedNode = useSelectedNode(graph.nodes)\n\tconst points = useMemo(() => {\n\t\treturn graph.nodes.map(n => new Vector3(convertGraphX(n.x), convertGraphY(n.y), -0.1))\n\t}, [graph])\n\tconsole.log({ selectedNode })\n\treturn <>\n\t\t<Cam points={points} />\n\t\t{\n\t\t\tgraph.nodes.map((n, i) => (<Text\n\t\t\t\tkey={n.name + selectedNode}\n\t\t\t\ttext={n.name}\n\t\t\t\tcolor={i === selectedNode ? \"black\" : \"white\"}\n\t\t\t\twidth={convertWidth(n.width)}\n\t\t\t\theight={convertHeight(n.height)}\n\t\t\t\tdepth={0.2}\n\t\t\t\tposition={[convertGraphX(n.x), convertGraphY(n.y), -0.1]} />))\n\t\t}\n\t\t{graph.edges.map(edge => {\n\t\t\tconst path = new CatmullRomCurve3(edge.points.map(point => new Vector3(convertGraphX(point.x), convertGraphY(point.y), -0.1)), false, \"catmullrom\")\n\t\t\treturn (<mesh >\n\t\t\t\t<tubeGeometry\n\t\t\t\t\tattach=\"geometry\"\n\t\t\t\t\targs={[path, 30, 0.03, 8, false]}\n\t\t\t\t/>\n\t\t\t\t<meshPhongMaterial attach=\"material\" color=\"grey\" />\n\t\t\t</mesh>);\n\t\t})}\n\t</>\n\n}\n\n\nexport default function App() {\n\tconst height = 6;\n\tconst width = 50;\n\tconst vwapEngine = \"VWAP Engine\"\n\tconst oms = \"OMS\"\n\tconst market = \"Exch Links\"\n\tconst trading = \"Trading Sys\"\n\tconst prices = \"MD Sys\"\n\tconst client = \"Client\"\n\tconst clientSys = \"Client Int\"\n\tconst graph = useDag([\n\t\t{ name: \"Config\", width, height },\n\t\t{ name: \"Ref Data Svc\", width, height },\n\t\t{ name: \"EOD Prices\", width, height },\n\t\t{ name: prices, width, height },\n\t\t{ name: client, width, height },\n\t\t{ name: clientSys, width, height },\n\t\t{ name: vwapEngine, width, height },\n\t\t{ name: oms, width, height },\n\t\t{ name: market, width, height },\n\t\t{ name: trading, width, height }\n\t], [\n\t\t{ from: \"Config\", to: vwapEngine },\n\t\t{ from: client, to: clientSys },\n\t\t{ from: clientSys, to: oms },\n\t\t{ from: \"Ref Data Svc\", to: vwapEngine },\n\t\t{ from: prices, to: vwapEngine },\n\t\t{ from: \"EOD Prices\", to: vwapEngine },\n\t\t{ from: vwapEngine, to: oms },\n\t\t{ from: oms, to: market },\n\t\t{ from: market, to: trading },\n\t\t{ from: trading, to: clientSys }\n\t],\n\t\t\"RL\");\n\treturn (\n\t\t<Canvas pixelRatio={window.devicePixelRatio}>\n\n\t\t\t<ambientLight />\n\t\t\t{/* <pointLight position={[3, 30, 10]} /> */}\n\t\t\t<spotLight position={[10, -30, 10]} color={new Color(\"#4040ff\")} rotation={[0.2, -0.2, 0]} />\n\t\t\t<spotLight position={[-10, -30, 10]} color={new Color(\"#90ff90\")} rotation={[0.2, 0.2, 0]} />\n\t\t\t<Graph graph={graph} />\n\t\t</Canvas>\n\t)\n}\n","import React from 'react';\nimport logo from './logo.svg';\nimport './App.css';\nimport Stuff from \"./graph\"\n\nconst App: React.FC = () => {\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        DAG Component\n      </header>\n      <Stuff />\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}